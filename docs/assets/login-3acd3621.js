import{j as E,S as I,i as D,s as L,e as d,f as g,a,b as R,g as r,k as b,m as k,p as $,n as z,d as j,r as q,o as O,l as F}from"./utils-2aa2b99c.js";const J={}.SERVER_URL;async function N(t){const e=await t.json();if(t.ok)return console.log("IT WORKED",t),e;throw{name:"servicesError",message:e}}async function P(t){const e=await fetch(J+"/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return await N(e)}class w extends Error{}w.prototype.name="InvalidTokenError";function V(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,s)=>{let o=s.charCodeAt(0).toString(16).toUpperCase();return o.length<2&&(o="0"+o),"%"+o}))}function x(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return V(e)}catch{return atob(e)}}function K(t,e){if(typeof t!="string")throw new w("Invalid token specified: must be a string");e||(e={});const s=e.header===!0?0:1,o=t.split(".")[s];if(typeof o!="string")throw new w(`Invalid token specified: missing part #${s+1}`);let n;try{n=x(o)}catch(i){throw new w(`Invalid token specified: invalid base64 for part #${s+1} (${i.message})`)}try{return JSON.parse(n)}catch(i){throw new w(`Invalid token specified: invalid json for part #${s+1} (${i.message})`)}}const A="so-token";async function H(t,e="/"){try{const s=await P(t);E(A,s.accessToken),M(s.accessToken)&&(window.location=e)}catch(s){alertMessage(s.message)}}function M(t){if(t){const e=K(t);let s=new Date;return e.exp*1e3<s.getTime()?(console.log("Token expired."),!1):(console.log("Valid token"),!0)}else return!1}function W(t){let e,s,o,n,i,h,l,y,c,T,u,S,m,C,f,_,U;return{c(){e=d("main"),s=d("h1"),s.textContent="Login Form",o=g(),n=d("form"),i=d("label"),i.textContent="Username:",h=g(),l=d("input"),y=g(),c=d("label"),c.textContent="Password:",T=g(),u=d("input"),S=g(),m=d("button"),m.textContent="Login",C=g(),f=d("button"),f.textContent="Sign Up",a(i,"for","username"),a(i,"class","svelte-uwif6z"),a(l,"type","text"),a(l,"id","username"),l.required=!0,a(l,"class","svelte-uwif6z"),a(c,"for","password"),a(c,"class","svelte-uwif6z"),a(u,"type","password"),a(u,"id","password"),u.required=!0,a(u,"class","svelte-uwif6z"),a(m,"type","submit"),a(m,"class","svelte-uwif6z"),a(f,"type","button"),a(f,"class","svelte-uwif6z"),a(n,"class","svelte-uwif6z"),a(e,"class","svelte-uwif6z")},m(p,v){R(p,e,v),r(e,s),r(e,o),r(e,n),r(n,i),r(n,h),r(n,l),b(l,t[0]),r(n,y),r(n,c),r(n,T),r(n,u),b(u,t[1]),r(n,S),r(n,m),r(n,C),r(n,f),_||(U=[k(l,"input",t[3]),k(u,"input",t[4]),k(f,"click",t[5]),k(n,"submit",$(t[2]))],_=!0)},p(p,[v]){v&1&&l.value!==p[0]&&b(l,p[0]),v&2&&u.value!==p[1]&&b(u,p[1])},i:z,o:z,d(p){p&&j(e),_=!1,q(U)}}}function B(t,e,s){let o="",n="";async function i(){console.log("Username:",o),console.log("Password:",n);const c=O(this);c.email=o,c.password=n,console.log("cred:",c),await H(c)}function h(){o=this.value,s(0,o)}function l(){n=this.value,s(1,n)}return[o,n,i,h,l,()=>window.location.href="/signup.html"]}class G extends I{constructor(e){super(),D(this,e,B,W,L,{})}}F();new G({target:document.querySelector(".login-form")});
